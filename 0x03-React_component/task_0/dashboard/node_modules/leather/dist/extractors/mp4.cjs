'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var util = require('../util.cjs');

const MIME_TYPES = {
    ['667479704d345620']: 'video/x-m4v',
    ['6674797071742020']: 'video/quicktime',
};

function attributes(input) {
    const stream = util.lazystream(input);
    const startIndex = stream.indexOf(Buffer.from('tkhd'));
    const type = stream.skip(4).take(8).toString('hex');
    const mime = MIME_TYPES[type] || 'video/mp4';

    const result = {
        width: 0,
        height: 0,
        size: stream.size(),
        mime,
    };

    if (startIndex !== -1) {
        result.width = stream.goto(startIndex).skip(78).takeUInt32BE();
        result.height = stream.takeUInt32BE();
    }

    stream.close();

    return result;
}

exports.attributes = attributes;
